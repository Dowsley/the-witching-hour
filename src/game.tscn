[gd_scene load_steps=44 format=3 uid="uid://duntd7q6i6x1y"]

[ext_resource type="PackedScene" uid="uid://dufoyugceah2k" path="res://src/vial/vial.tscn" id="1"]
[ext_resource type="Texture2D" uid="uid://bpd58bscflavh" path="res://assets/img/bricks_16b.png" id="2"]
[ext_resource type="Texture2D" uid="uid://vfa3awhrcelw" path="res://assets/img/flat_cup.png" id="3"]
[ext_resource type="Texture2D" uid="uid://bpkxwo1k7xiek" path="res://assets/img/flat_cup_mask.png" id="4"]
[ext_resource type="Shader" path="res://data/shaders/liquid.gdshader" id="4_0xhes"]
[ext_resource type="Texture2D" uid="uid://hlyyxjvct00c" path="res://assets/img/fill_flat.png" id="7"]
[ext_resource type="Texture2D" uid="uid://baxbw7hv0a1e" path="res://assets/img/gin_bottle.png" id="8"]
[ext_resource type="Texture2D" uid="uid://7m62mrdqp3ta" path="res://assets/img/gin_mask.png" id="9"]

[sub_resource type="RectangleShape2D" id="1"]
size = Vector2(320, 16)

[sub_resource type="ShaderMaterial" id="ShaderMaterial_7cahm"]
resource_local_to_scene = true
shader = ExtResource("4_0xhes")
shader_parameter/Color = Color(1, 0, 0, 1)
shader_parameter/SurfaceRotation = null
shader_parameter/Fill = 0.6
shader_parameter/NoiseScale = 10.0
shader_parameter/MinOpacity = 0.7
shader_parameter/FillTexture = ExtResource("7")

[sub_resource type="RectangleShape2D" id="RectangleShape2D_s4cwl"]
size = Vector2(13, 19)

[sub_resource type="RectangleShape2D" id="RectangleShape2D_8hi5p"]
size = Vector2(14.625, 21)

[sub_resource type="VisualShaderNodeFloatParameter" id="VisualShaderNodeFloatParameter_j18gt"]
parameter_name = "NoiseScale"

[sub_resource type="VisualShaderNodeFloatOp" id="2"]
output_port_for_preview = 0
default_input_values = [0, 0.0, 1, 1.0]
operator = 2

[sub_resource type="VisualShaderNodeInput" id="3"]
input_name = "time"

[sub_resource type="VisualShaderNodeInput" id="4"]
output_port_for_preview = 0
input_name = "uv"

[sub_resource type="VisualShaderNodeColorParameter" id="5"]
output_port_for_preview = 0
parameter_name = "Color"

[sub_resource type="VisualShaderNodeFloatOp" id="6"]
output_port_for_preview = 0
operator = 2

[sub_resource type="VisualShaderNodeFloatParameter" id="7"]
parameter_name = "SurfaceRotation"

[sub_resource type="VisualShaderNodeClamp" id="8"]
output_port_for_preview = 0

[sub_resource type="VisualShaderNodeTexture" id="9"]
output_port_for_preview = 1
source = 2
texture_type = 1

[sub_resource type="VisualShaderNodeFloatParameter" id="10"]
parameter_name = "MinOpacity"

[sub_resource type="VisualShaderNodeTexture2DParameter" id="11"]
output_port_for_preview = 1
parameter_name = "FillTexture"

[sub_resource type="VisualShaderNodeVectorOp" id="12"]
output_port_for_preview = 0
default_input_values = [0, Vector3(0, 0, 0), 1, Vector3(0, -0.75, 0)]

[sub_resource type="VisualShaderNodeVectorCompose" id="13"]

[sub_resource type="VisualShaderNodeFloatParameter" id="14"]
parameter_name = "Fill"

[sub_resource type="VisualShaderNodeFloatOp" id="15"]
default_input_values = [0, 0.0, 1, 1.0]
operator = 1

[sub_resource type="VisualShaderNodeVectorCompose" id="16"]
default_input_values = [0, 0.5, 1, 0.2, 2, 0.0]

[sub_resource type="VisualShaderNodeVectorOp" id="17"]
default_input_values = [0, Vector3(0, 0, 0), 1, Vector3(1, 1, 1)]
operator = 2

[sub_resource type="VisualShaderNodeVectorOp" id="18"]
operator = 1

[sub_resource type="VisualShaderNodeVectorOp" id="19"]
output_port_for_preview = 0

[sub_resource type="VisualShaderNodeVectorCompose" id="20"]
default_input_values = [0, 1.0, 1, 1.0, 2, 1.0]

[sub_resource type="VisualShaderNodeFloatFunc" id="21"]
function = 1

[sub_resource type="VisualShaderNodeCustom" id="22"]
output_port_for_preview = 0
initialized = true

[sub_resource type="VisualShaderNodeVectorDecompose" id="23"]

[sub_resource type="VisualShaderNodeVectorCompose" id="24"]
output_port_for_preview = 0

[sub_resource type="VisualShaderNodeCustom" id="25"]
output_port_for_preview = 1
default_input_values = [1, Vector3(1, 1, 1), 2, 1.0]
initialized = true

[sub_resource type="VisualShaderNodeFloatOp" id="26"]
default_input_values = [0, 0.0, 1, 0.2]
operator = 2

[sub_resource type="VisualShaderNodeVectorOp" id="27"]
output_port_for_preview = 0
operator = 2

[sub_resource type="VisualShader" id="VisualShader_i373j"]
code = "shader_type canvas_item;
render_mode blend_mix;

uniform vec4 Color : source_color;
uniform float MinOpacity;



void fragment() {
	vec4 n_out36p0;
// Texture2D:36
	n_out36p0 = texture(TEXTURE, UV);


// ColorParameter:2
	vec4 n_out2p0 = Color;


// VectorOp:9
	vec3 n_out9p0 = vec3(n_out36p0.xyz) * vec3(n_out2p0.xyz);


// FloatOp:23
	float n_in23p0 = 0.00000;
	float n_in23p1 = 0.00000;
	float n_out23p0 = n_in23p0 * n_in23p1;


// FloatParameter:37
	float n_out37p0 = MinOpacity;


// Clamp:35
	float n_in35p0 = 0.00000;
	float n_in35p2 = 1.00000;
	float n_out35p0 = clamp(n_in35p0, n_out37p0, n_in35p2);


// FloatOp:12
	float n_out12p0 = n_out23p0 * n_out35p0;


// Output:0
	COLOR.rgb = n_out9p0;
	COLOR.a = n_out12p0;


}
"
graph_offset = Vector2(-2427.07, -649.411)
mode = 1
flags/light_only = false
nodes/fragment/0/position = Vector2(2680, 200)
nodes/fragment/2/node = SubResource("5")
nodes/fragment/2/position = Vector2(1640, -500)
nodes/fragment/9/node = SubResource("27")
nodes/fragment/9/position = Vector2(2160, -660)
nodes/fragment/11/node = SubResource("VisualShaderNodeFloatParameter_j18gt")
nodes/fragment/11/position = Vector2(-400, 1560)
nodes/fragment/12/node = SubResource("2")
nodes/fragment/12/position = Vector2(2160, 260)
nodes/fragment/14/node = SubResource("3")
nodes/fragment/14/position = Vector2(-1360, 1440)
nodes/fragment/16/node = SubResource("4")
nodes/fragment/16/position = Vector2(-3000, -840)
nodes/fragment/23/node = SubResource("6")
nodes/fragment/23/position = Vector2(1640, 100)
nodes/fragment/25/node = SubResource("7")
nodes/fragment/25/position = Vector2(-2440, -820)
nodes/fragment/35/node = SubResource("8")
nodes/fragment/35/position = Vector2(840, 1380)
nodes/fragment/36/node = SubResource("9")
nodes/fragment/36/position = Vector2(580, -960)
nodes/fragment/37/node = SubResource("10")
nodes/fragment/37/position = Vector2(260, 1720)
nodes/fragment/38/node = SubResource("11")
nodes/fragment/38/position = Vector2(600, 20)
nodes/fragment/40/node = SubResource("12")
nodes/fragment/40/position = Vector2(-1020, -160)
nodes/fragment/43/node = SubResource("13")
nodes/fragment/43/position = Vector2(-1560, -80)
nodes/fragment/44/node = SubResource("14")
nodes/fragment/44/position = Vector2(-2460, -20)
nodes/fragment/45/node = SubResource("15")
nodes/fragment/45/position = Vector2(-1980, -80)
nodes/fragment/48/node = SubResource("16")
nodes/fragment/48/position = Vector2(-2500, -1340)
nodes/fragment/49/node = SubResource("17")
nodes/fragment/49/position = Vector2(-1280, -1520)
nodes/fragment/50/node = SubResource("18")
nodes/fragment/50/position = Vector2(-1640, -1520)
nodes/fragment/51/node = SubResource("19")
nodes/fragment/51/position = Vector2(-920, -1520)
nodes/fragment/52/node = SubResource("20")
nodes/fragment/52/position = Vector2(-1720, -820)
nodes/fragment/53/node = SubResource("21")
nodes/fragment/53/position = Vector2(-2100, -820)
nodes/fragment/56/node = SubResource("22")
nodes/fragment/56/position = Vector2(-420, -320)
nodes/fragment/59/node = SubResource("23")
nodes/fragment/59/position = Vector2(-1020, 1020)
nodes/fragment/60/node = SubResource("24")
nodes/fragment/60/position = Vector2(-420, 1100)
nodes/fragment/61/node = SubResource("25")
nodes/fragment/61/position = Vector2(220, 1220)
nodes/fragment/62/node = SubResource("26")
nodes/fragment/62/position = Vector2(-900, 1300)
nodes/fragment/connections = PackedInt32Array(23, 0, 12, 0, 37, 0, 35, 1, 9, 0, 0, 0, 43, 0, 40, 1, 44, 0, 45, 0, 45, 0, 43, 1, 16, 0, 50, 0, 48, 0, 50, 1, 50, 0, 49, 0, 49, 0, 51, 0, 48, 0, 51, 1, 51, 0, 40, 0, 52, 0, 49, 1, 53, 0, 52, 0, 12, 0, 0, 1, 35, 0, 12, 1, 25, 0, 53, 0, 16, 0, 59, 0, 59, 0, 60, 0, 59, 1, 60, 1, 14, 0, 62, 0, 62, 0, 60, 2, 36, 0, 9, 0, 2, 0, 9, 1)

[sub_resource type="ShaderMaterial" id="ShaderMaterial_cwoqo"]
resource_local_to_scene = true
shader = SubResource("VisualShader_i373j")
shader_parameter/Color = Color(1, 0, 0, 1)
shader_parameter/MinOpacity = 0.7

[sub_resource type="RectangleShape2D" id="RectangleShape2D_sovyg"]
size = Vector2(15, 26)

[sub_resource type="RectangleShape2D" id="RectangleShape2D_sq3k6"]
size = Vector2(16, 28)

[node name="Game" type="Node2D"]

[node name="BG" type="ColorRect" parent="."]
z_index = -100
offset_right = 320.0
offset_bottom = 180.0
mouse_filter = 2
color = Color(0.254096, 0.133508, 0.241587, 1)

[node name="Table" type="StaticBody2D" parent="."]
position = Vector2(0, 164)

[node name="BrickBG" type="Sprite2D" parent="Table"]
modulate = Color(1, 1, 1, 0.709804)
texture_repeat = 2
position = Vector2(160, 8)
texture = ExtResource("2")
region_enabled = true
region_rect = Rect2(0, 0, 320, 16)

[node name="CollisionShape2D" type="CollisionShape2D" parent="Table"]
position = Vector2(160, 8)
shape = SubResource("1")

[node name="Cup" parent="." instance=ExtResource("1")]
position = Vector2(258, 148)
percent_filled = 1.0

[node name="LiquidSpillPos" parent="Cup" index="0"]
position = Vector2(0, -4)

[node name="Sprite2D" parent="Cup" index="1"]
texture = ExtResource("3")

[node name="Liquid" parent="Cup/Sprite2D" index="0"]
material = SubResource("ShaderMaterial_7cahm")
texture = ExtResource("4")

[node name="CollisionShape2D" parent="Cup" index="2"]
position = Vector2(-0.5, 6.5)
shape = SubResource("RectangleShape2D_s4cwl")

[node name="CollisionShape2D" parent="Cup/DraggableArea" index="0"]
position = Vector2(-0.3125, 6.5)
shape = SubResource("RectangleShape2D_8hi5p")

[node name="GinBottle" parent="." instance=ExtResource("1")]
position = Vector2(207, 151)

[node name="Sprite2D" parent="GinBottle" index="1"]
texture = ExtResource("8")

[node name="Liquid" parent="GinBottle/Sprite2D" index="0"]
material = SubResource("ShaderMaterial_cwoqo")
texture = ExtResource("9")

[node name="CollisionShape2D" parent="GinBottle" index="2"]
position = Vector2(0.5, 0)
shape = SubResource("RectangleShape2D_sovyg")

[node name="CollisionShape2D" parent="GinBottle/DraggableArea" index="0"]
visible = false
shape = SubResource("RectangleShape2D_sq3k6")

[node name="Vial" parent="." instance=ExtResource("1")]
position = Vector2(157, 149)

[editable path="Cup"]
[editable path="GinBottle"]
